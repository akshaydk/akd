(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{211:function(e,t){const n={render:function(){this.$createElement;return this._self._c,this._m(0)},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"dynamicMarkdown"},[n("p",[e._v("We had a requirement of installing MariaDB to an existing docker image because\nthe test cases had to run within the same image and the rails framework needs a test database to\nrun the tests.")]),e._v(" "),n("p",[e._v("After installing the MariaDB using yum, we tried to start the sql server within the container, it threw")]),e._v(" "),n("pre",{staticClass:"language-shell"},[n("code",{pre:!0,attrs:{class:"language-shell"}},[e._v("ERROR "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("2002")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("HY000"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(": Cant connect to "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("local")]),e._v(" MySQL server through socket /var/lib/mysql/mysql.sock\n")])]),e._v(" "),n("p",[e._v("Excerpts of step from the "),n("a",{attrs:{href:"https://dba.stackexchange.com/questions/185498/centos-container-installing-mariadb-server"}},[e._v("article")]),e._v(":")]),e._v(" "),n("ul",[n("li",[e._v("start the service manually and")]),e._v(" "),n("li",[e._v("ensure that you have started it such that it will stay in the foreground (because a Docker container exits when the foreground process exits or puts itself into the background).")])]),e._v(" "),n("p",[e._v("Inside a docker container, nothing will run  by default. The following code when executed within the container will start the server.")]),e._v(" "),n("pre",{staticClass:"language-shell"},[n("code",{pre:!0,attrs:{class:"language-shell"}},[e._v("/usr/libexec/mariadb-prepare-db-dir mariadb.service\u2028\n\n/usr/bin/mysqld_safe --basedir"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/usr "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&")]),e._v("\u2028\n")])]),e._v(" "),n("p",[e._v("We added these lines to our Dockerfile and every time sql-server was started during the boot up.")])])}]};e.exports={attributes:{name:"mariadb_in_image",title:"Installing MariaDB to an existing Docker Image",date:"2020-02-01 13:00:00 +0530",categories:"Docker, MySQL, MariaDB",description:"Need db in the container where your code resides? Not a best practice but we had to do.\n"},vue:{render:n.render,staticRenderFns:n.staticRenderFns,component:{data:function(){return{templateRender:null}},render:function(e){return this.templateRender?this.templateRender():e("div","Rendering")},created:function(){this.templateRender=n.render,this.$options.staticRenderFns=n.staticRenderFns}}}}}}]);